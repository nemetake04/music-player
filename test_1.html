<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ドラッグ音楽プレーヤー</title>
<style>
  #tracks {
    display: flex;
    gap: 10px; 
    margin-bottom: 15px;
  }
  .track {
    width: 50px;
    height: 50px;
    background: #ddd;
    border: 2px solid #333;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    cursor: grab;
    user-select: none;
  }
</style>
</head>
<body>

<h2>並び替えて再生</h2>

<div id="tracks">
  <div class="track" draggable="true" data-key="A">A</div>
  <div class="track" draggable="true" data-key="B">B</div>
  <div class="track" draggable="true" data-key="C">C</div>
  <div class="track" draggable="true" data-key="D">D</div>
  <div class="track" draggable="true" data-key="E">E</div>
</div>

<button onclick="startPlay()">再生</button>
<br><br>

<audio id="player" controls></audio>

<script>
const sounds = {
  A: "frag_A.wav",
  B: "frag_B.wav",
  C: "frag_C.wav",
  D: "frag_D.wav",
  E: "frag_E.wav"
};

const player = document.getElementById("player");
let playlist = [];
let index = 0;

/* ドラッグ並び替え */
let dragged;
document.querySelectorAll(".track").forEach(t => {
  t.addEventListener("dragstart", () => dragged = t);
  t.addEventListener("dragover", e => e.preventDefault());
  t.addEventListener("drop", e => {
    e.preventDefault();
    if (dragged !== t) {
      const parent = t.parentNode;
      parent.insertBefore(dragged, t);
    }
  });
});

/* 再生開始 */
function startPlay() {
  playlist = [...document.querySelectorAll(".track")]
    .map(t => t.dataset.key);
  index = 0;
  playCurrent();
}

function playCurrent() {
  player.src = sounds[playlist[index]];
  player.play();
}

/* 曲が終わったら次へ */
player.addEventListener("ended", () => {
  index++;
  if (index < playlist.length) {
    playCurrent();
  }
});
</script>

</body>
</html>
